# ๐ง Persian BERT (HuggingFace-based)

ุงู ูพุฑูฺู ูุณุฎูโุง ุจุงุฒููุณโุดุฏู ุงุฒ BERT ุจุฑุง ุฒุจุงู ูุงุฑุณ ุงุณุช ฺฉู ุจูโุฌุง TensorFlow 1.x ุงุฒ ฺฉุชุงุจุฎุงููโ **HuggingFace Transformers** ู **PyTorch** ุงุณุชูุงุฏู ูโฺฉูุฏ.  
ฺฉุฏูุง ุจูโุตูุฑุช ฺฉุงูู ุจุงุฒุณุงุฒ ุดุฏูโุงูุฏ ุชุง ุจุชูุงู ุจุง ุฏุงุฏูโูุง ุฌุฏุฏ ูุงุฑุณ ูุงููุฏ **MirasText** ู **Wikipedia ูุงุฑุณ** ูุฏู BERT ุฑุง ุงุฒ ุตูุฑ ูพุดโุชูุฑู (pretrain) ฺฉุฑุฏ.

---

## โ๏ธ ูพุดโูุงุฒูุง

### โ ูุณุฎูโ ูพุดููุงุฏ ูพุงุชูู
ุงู ูพุฑูฺู ุฏุฑ ูุญุท **Python 3.12.3** ุชุณุช ู ุชูุณุนู ุฏุงุฏู ุดุฏู ุงุณุช.  
ูุณุฎูโูุง ุจุงูุงุชุฑ (ุจูโูฺู **3.13** ู **3.14**) ููฺฉู ุงุณุช ุจุง ุจุฑุฎ ูพฺฉุฌโูุง ูุงููุฏ `torch` ุง `transformers` ูุงุณุงุฒฺฏุงุฑ ุจุงุดูุฏ (ุจูโุฎุตูุต ุฏุฑ ููฺฏุงู ูุตุจ ุจุง pip).

> โ๏ธ **ุชูุตู:**  
> ุงฺฏุฑ ุงุฒ ูุณุฎูโูุง ุฌุฏุฏุชุฑ ุงุณุชูุงุฏู ูโฺฉูุฏ ู ุจุง ุฎุทุง ูุตุจ ููุงุฌู ุดุฏุฏุ ฺฉ ุงุฒ ุฏู ุฑูุด ุฒุฑ ุฑุง ุงูุฌุงู ุฏูุฏ:

**ุฑูุด ฑ๏ธโฃ: ุงุณุชูุงุฏู ุงุฒ ูุณุฎูโ ูพุดููุงุฏ ูพุงุชูู (ูพุดููุงุฏโุชุฑู ฺฏุฒูู)**  
ุฏุฑ ูููฺฉุณ ุง ูฺฉ:
```bash
pyenv install 3.12.3
pyenv local 3.12.3
```
ุฏุฑ ููุฏูุฒ ูโุชูุงูุฏ ุงุฒ python.org ูุณุฎูโ 3.12.3 ุฑุง ุฏุงูููุฏ ฺฉูุฏ.
ุฑูุด ฒ๏ธโฃ: ุฑูุน ูุงุณุงุฒฺฏุงุฑ ุฏุฑ ูุณุฎูโูุง ุจุงูุงุชุฑ
ุงฺฏุฑ ูพุงุชูู ุดูุง 3.13 ุง 3.14 ุงุณุชุ ูุจู ุงุฒ ูุตุจ ุจุณุชูโูุง ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ ุชุง ูุณุฎูโ ุณุงุฒฺฏุงุฑ PyTorch ูุตุจ ุดูุฏ:
```bash
pip install torch==2.5.1 --index-url https://download.pytorch.org/whl/cpu
pip install transformers==4.46.1
```
ุฏุฑ ุตูุฑุช ูุฌูุฏ GPU ุงุฒ ุขุฏุฑุณ ูพฺฉุฌโูุง PyTorch ูุณุฎูโ ููุงุณุจ CUDA ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.

---

## ๐ฆ ูุตุจ ู ุงุฌุฑุง

### 1๏ธโฃ ุฏุฑุงูุช ุฑูพุงุฒุชูุฑ
```bash
git clone https://github.com/mohammadsaleh40/bert_hf.git
cd bert_hf
```
2๏ธโฃ ุงุฌุงุฏ ูุญุท ูุฌุงุฒ ู ูุตุจ ูุงุจุณุชฺฏโูุง

```bash
python3 -m venv venv
source venv/bin/activate       # ุฏุฑ ููุฏูุฒ: venv\Scripts\activate
pip install --upgrade pip
pip install -r requirements.txt
```
---
โ๏ธ ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง
ุงูู) ุฏุฑุงูุช ุฏุงุฏูโ ููููู MirasText
```bash
wget https://raw.githubusercontent.com/miras-tech/MirasText/refs/heads/master/MirasText/MirasText_sample.txt -O MirasText_sample.txt
```
ุจ) ูพุดโูพุฑุฏุงุฒุด ุฏุงุฏูโูุง
```bash
python prepare_mirastext.py
```
๐ ุฎุฑูุฌ: `mirastext_preprocessed.txt`

---
ุฌ) ุงูุฒูุฏู Wikipedia ูุงุฑุณ
1. ุฏุงูููุฏ ูุงู ูุดุฑุฏู ูฺฉโูพุฏุง ูุงุฑุณ:
```bash
wget https://dumps.wikimedia.org/fawiki/latest/fawiki-latest-pages-articles.xml.bz2
```
2. ุงุณุชุฎุฑุงุฌ ูุญุชูุง ูุชู ุจุง WikiExtractor:
```bash
python -m wikiextractor.WikiExtractor fawiki-latest-pages-articles.xml.bz2 -o fawiki-latest-pages-articles
```
3. ุงุถุงูู ฺฉุฑุฏู ููุงูุงุช ูฺฉโูพุฏุง ุจู ุงูุชูุง ุฏุงุฏูโ MirasText:
```bash
python add_wiki_to_preprocessed.py
```
๐ ุฎุฑูุฌ ููุง: `mirastext_preprocessed.txt` ุดุงูู MirasText + Wikipedia ูุงุฑุณ
---
๐งฐ ุณุงุฎุช ูุงฺฺฏุงู (ุงุฎุชุงุฑ)

ุฏุฑ ุตูุฑุช ุชูุงู ูโุชูุงูุฏ ูุงฺฺฏุงู ุฌุฏุฏ ุจุณุงุฒุฏ:
```bash
python create_vocab.py
```
ูุงู ุชููุฏ ูุงูุด ุจุงุฏ ุจู `vocab.txt` ุชุบุฑ ูพุฏุง ฺฉูุฏ. ุจุง ุฏุณุชูุฑ ุฒุฑ ุขู ุฑุง ุชุบุฑ ูโุฏูู.

```bash
mv persian_bert_tokenizer/wp-vocab.txt persian_bert_tokenizer/vocab.txt
```
---
๐ ุขููุฒุด ูุฏู BERT ูุงุฑุณ

ูุงู run_pretraining_hf_v2.py ูุณุฆูู ุงุฌุฑุง ุขููุฒุด ูุฏู ุจุฑ ูพุงูโ HuggingFace Trainer ุงุณุช.
ูพุงุฑุงูุชุฑูุง ุงุตู ุฏุฑูู ูุงู ุชุนุฑู ุดุฏูโุงูุฏ (ูุซู ุงูุฏุงุฒูโ ูุฏูุ ุชูฺฉูุงุฒุฑุ ูุณุฑ ุฏุงุฏูโูุง ู ุบุฑู).
```bash
python run_pretraining_hf_v2.py
```
๐ ุฎุฑูุฌ ูุฏู ุฐุฎุฑู ูโุดูุฏ ุฏุฑ ูุณุฑ:
```bash
persian_bert_tiny_output_large_2/
```
๐ ุจุฑุฑุณ ู ุชุณุช ูุฏู

ุจุฑุง ุขุฒูุงุด ูุฏู ุขููุฒุดโุฏุฏูุ ุฏู ุฑูุด ุฏุฑ ุฏุณุชุฑุณ ุงุณุช:

๐น ุฑูุด ฑ: ุงุฌุฑุง ูุณุชูู ุงุณฺฉุฑูพุช
```bash
python check_model.py
```
ุงู ูุงู ฺูุฏ ุฌูููโ ูุงุฑุณ ุฑุง ูพุฑุฏุงุฒุด ฺฉุฑุฏู ู ุจุง ุงุณุชูุงุฏู ุงุฒ t-SNE ุชูุฒุน ุจุฑุฏุงุฑูุง ฺฉููุงุช ุฑุง ููุงุด ูโุฏูุฏ.
---

๐น ุฑูุด ฒ: ุงุณุชูุงุฏู ุงุฒ ููุชโุจูฺฉ

ูุงู chek_model.ipynb ุฑุง ุจุง Jupyter ุจุงุฒ ฺฉูุฏ:
```bash
jupyter notebook chek_model.ipynb
```
ุฏุฑ ุงู ููุชโุจูฺฉ:

ูุฏู ุงุฒ ูุณุฑ `persian_bert_tiny_final_model_large_2` ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ.

ฺูุฏ ุฌูููโ ูุงุฑุณ ููููู ุจู ูุฏู ุฏุงุฏู ูโุดูุฏ.

ู ุฎุฑูุฌโูุง (embedding ู ุดุจุงูุชโูุง) ุจุฑุฑุณ ูโุดููุฏ.
